<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Company Personnel Manager</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f9f9f9;
    }

    h2 {
      color: #333;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    form, table, .search-box {
      margin-top: 20px;
    }

    fieldset {
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 8px;
      background-color: #fff;
    }

    legend {
      font-weight: bold;
      padding: 0 10px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      margin-bottom: 15px;
    }

    label {
      margin-bottom: 5px;
      font-weight: bold;
    }

    input, select, button {
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      width: fit-content;
      background-color: #007bff;
      color: white;
      border: none;
    }

    button:hover {
      background-color: #0056b3;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      background-color: #fff;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: left;
    }

    th {
      background-color: #eaeaea;
    }

    .btn {
      padding: 6px 10px;
      margin-right: 5px;
      cursor: pointer;
      border-radius: 4px;
    }

    .edit-btn {
      background-color: #ffc107;
      border: none;
    }

    .delete-btn {
      background-color: #dc3545;
      border: none;
      color: white;
    }

    .search-box input {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
    }

    @media (max-width: 600px) {
      .form-group {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Company Personnel Manager</h2>

    <div class="form-group">
      <label for="companySelect">Select Company:</label>
      <select id="companySelect"></select>
    </div>

    <div class="form-group">
      <label for="role">Select Role:</label>
      <select id="role">
        <option value="Admin">Admin</option>
        <option value="Viewer">Viewer</option>
      </select>
    </div>

    <div class="company-header" role="region" aria-label="Company Summary">
      <h2 id="headerCompanyName"></h2>
      <p id="headerLocation"></p>
      <p id="headerType"></p>
      <p id="headerRole"></p>
    </div>

    <div id="adminPanel">
      <form id="personnelForm">
        <fieldset>
          <legend>Add Personnel Record</legend>
          <div class="form-group">
            <label for="name">Full Name:</label>
            <input type="text" id="name" required />
          </div>
          <div class="form-group">
            <label for="position">Position:</label>
            <input type="text" id="position" required />
          </div>
          <div class="form-group">
            <label for="department">Department:</label>
            <input type="text" id="department" required />
          </div>
          <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" required />
          </div>
          <div class="form-group">
            <label for="businessNames">Business Name(s):</label>
            <div id="businessDropdownContainer"></div>
          </div>
          <button type="submit" class="btn">Add Record</button>
        </fieldset>
      </form>
    </div>

    <div class="search-box">
      <label for="searchInput">Search:</label>
      <input type="text" id="searchInput" placeholder="Search by any field..." />
    </div>

    <table id="recordsTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Position</th>
          <th>Department</th>
          <th>Email</th>
          <th>Business(es)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const companies = [
      { name: "Alpha Corp", location: "New York, NY", type: "Tech", contributors: ["Admin", "Viewer"] },
      { name: "Beta LLC", location: "Austin, TX", type: "Finance", contributors: ["Admin"] },
      { name: "Gamma Inc", location: "Seattle, WA", type: "Retail", contributors: ["Viewer"] },
      { name: "Delta Partners", location: "Chicago, IL", type: "Consulting", contributors: ["Admin", "Viewer"] }
    ];

    const form = document.getElementById('personnelForm');
    const tableBody = document.querySelector('#recordsTable tbody');
    const searchInput = document.getElementById('searchInput');
    const roleSelect = document.getElementById('role');
    const companySelect = document.getElementById('companySelect');
    const adminPanel = document.getElementById('adminPanel');

    let currentCompany = companies[0].name;
    let companyRecords = {};

    function populateCompanySelect() {
      companies.forEach(c => {
        const option = document.createElement('option');
        option.value = c.name;
        option.textContent = c.name;
        companySelect.appendChild(option);
      });
      companySelect.value = currentCompany;
    }

    function updateCompanyHeader(name) {
      const company = companies.find(c => c.name === name);
      document.getElementById('headerCompanyName').textContent = company.name;
      document.getElementById('headerLocation').textContent = company.location;
      document.getElementById('headerType').innerHTML = `Type: <span>${company.type}</span>`;
      document.getElementById('headerRole').innerHTML = `Role: <span>${roleSelect.value}</span>`;
    }

    function getFilteredBusinesses(role) {
      return companies.filter(c => c.contributors.includes(role));
    }

    function renderBusinessDropdown(role) {
      const container = document.getElementById('businessDropdownContainer');
      container.innerHTML = '';

      const select = document.createElement('select');
      select.id = 'businessNames';
      select.multiple = true;

      getFilteredBusinesses(role).forEach(b => {
        const option = document.createElement('option');
        option.value = b.name;
        option.textContent = b.name;
        select.appendChild(option);
      });

      container.appendChild(select);
    }

    function renderTable() {
      const role = roleSelect.value;
      const query = searchInput.value.toLowerCase();
      const records = companyRecords[currentCompany] || [];
      tableBody.innerHTML = '';

      records
        .filter(record =>
          Object.values(record).some(val =>
            Array.isArray(val)
              ? val.join(', ').toLowerCase().includes(query)
              : val.toLowerCase().includes(query)
          )
        )
        .forEach((record, index) => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${record.name}</td>
            <td>${record.position}</td>
            <td>${record.department}</td>
            <td>${record.email}</td>
            <td>${record.businesses.join(', ')}</td>
            <td>
              ${role === 'Admin' ? `
                <button class="btn edit-btn" onclick="editRecord(${index})">Edit</button>
                <button class="btn delete-btn" onclick="deleteRecord(${index})">Delete</button>
              ` : '—'}
            </td>
          `;
          tableBody.appendChild(row);
        });
    }

    function deleteRecord(index) {
      companyRecords[currentCompany].splice(index, 1);
      renderTable();
    }

    function editRecord(index) {
      const record = companyRecords[currentCompany][index];
      document.getElementById('name').value = record.name;
      document.getElementById('position').value = record.position;
      document.getElementById('department').value = record.department;
      document.getElementById('email').value = record.email;

      renderBusinessDropdown(roleSelect.value);
      const businessSelect = document.getElementById('businessNames');
      Array.from(businessSelect.options

<script>
  const companies = [
    { name: "Alpha Corp", location: "New York, NY", type: "Tech", contributors: ["Admin", "Viewer"] },
    { name: "Beta LLC", location: "Austin, TX", type: "Finance", contributors: ["Admin"] },
    { name: "Gamma Inc", location: "Seattle, WA", type: "Retail", contributors: ["Viewer"] },
    { name: "Delta Partners", location: "Chicago, IL", type: "Consulting", contributors: ["Admin", "Viewer"] }
  ];

  const form = document.getElementById('personnelForm');
  const tableBody = document.querySelector('#recordsTable tbody');
  const searchInput = document.getElementById('searchInput');
  const roleSelect = document.getElementById('role');
  const companySelect = document.getElementById('companySelect');
  const adminPanel = document.getElementById('adminPanel');

  let currentCompany = companies[0].name;
  let companyRecords = {};

  function populateCompanySelect() {
    companies.forEach(c => {
      const option = document.createElement('option');
      option.value = c.name;
      option.textContent = c.name;
      companySelect.appendChild(option);
    });
    companySelect.value = currentCompany;
  }

  function updateCompanyHeader(name) {
    const company = companies.find(c => c.name === name);
    document.getElementById('headerCompanyName').textContent = company.name;
    document.getElementById('headerLocation').textContent = company.location;
    document.getElementById('headerType').innerHTML = `Type: <span>${company.type}</span>`;
    document.getElementById('headerRole').innerHTML = `Role: <span>${roleSelect.value}</span>`;
  }

  function getFilteredBusinesses(role) {
    return companies.filter(c => c.contributors.includes(role));
  }

  function renderBusinessDropdown(role) {
    const container = document.getElementById('businessDropdownContainer');
    container.innerHTML = '';

    const select = document.createElement('select');
    select.id = 'businessNames';
    select.multiple = true;

    getFilteredBusinesses(role).forEach(b => {
      const option = document.createElement('option');
      option.value = b.name;
      option.textContent = b.name;
      select.appendChild(option);
    });

    container.appendChild(select);
  }

  function renderTable() {
    const role = roleSelect.value;
    const query = searchInput.value.toLowerCase();
    const records = companyRecords[currentCompany] || [];
    tableBody.innerHTML = '';

    records
      .filter(record =>
        Object.values(record).some(val =>
          Array.isArray(val)
            ? val.join(', ').toLowerCase().includes(query)
            : val.toLowerCase().includes(query)
        )
      )
      .forEach((record, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${record.name}</td>
          <td>${record.position}</td>
          <td>${record.department}</td>
          <td>${record.email}</td>
          <td>${record.businesses.join(', ')}</td>
          <td>
            ${role === 'Admin' ? `
              <button class="btn edit-btn" onclick="editRecord(${index})">Edit</button>
              <button class="btn delete-btn" onclick="deleteRecord(${index})">Delete</button>
            ` : '—'}
          </td>
        `;
        tableBody.appendChild(row);
      });
  }

  function deleteRecord(index) {
    companyRecords[currentCompany].splice(index, 1);
    renderTable();
  }

  function editRecord(index) {
    const record = companyRecords[currentCompany][index];
    document.getElementById('name').value = record.name;
    document.getElementById('position').value = record.position;
    document.getElementById('department').value = record.department;
    document.getElementById('email').value = record.email;

    renderBusinessDropdown(roleSelect.value);
    const businessSelect = document.getElementById('businessNames');
    Array.from(businessSelect.options).forEach(opt => {
      opt.selected = record.businesses.includes(opt.value);
    });

    companyRecords[currentCompany].splice(index, 1);
    renderTable();
  }

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const selectedBusinesses = Array.from(document.getElementById('businessNames').selectedOptions).map(opt => opt.value);
    const record = {
      name: document.getElementById('name').value.trim(),
      position: document.getElementById('position').value.trim(),
      department: document.getElementById('department').value.trim(),
      email: document.getElementById('email').value.trim(),
      businesses: selectedBusinesses
    };
    if (!companyRecords[currentCompany]) companyRecords[currentCompany] = [];
    companyRecords[currentCompany].push(record);
    form.reset();
    renderTable();
  });

  roleSelect.addEventListener('change', () => {
    const role = roleSelect.value;
    adminPanel.style.display = role === 'Admin' ? 'block' : 'none';
    updateCompanyHeader(currentCompany);
    renderBusinessDropdown(role);
    renderTable();
  });

  companySelect.addEventListener('change', (e) => {
    currentCompany = e.target.value;
    updateCompanyHeader(currentCompany);
    renderBusinessDropdown(roleSelect.value);
    renderTable();
  });

  searchInput.addEventListener('input', renderTable);

  // Initial setup
  populateCompanySelect();
  updateCompanyHeader(currentCompany);
  renderBusinessDropdown(roleSelect.value);
  renderTable();
</script>
</body>
</html>