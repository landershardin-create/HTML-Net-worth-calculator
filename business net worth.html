<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Business Net Worth Report</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    h1 { color: #2c3e50; }
    select { margin-top: 1em; padding: 0.5em; font-size: 1em; }
    table { width: 100%; border-collapse: collapse; margin-top: 1em; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f0f0f0; }
    .asset { color: green; }
    .liability { color: red; }
    .summary { margin-top: 1em; font-size: 1.2em; }
  </style>
</head>
<body>
  <h1>Business Net Worth Report</h1>

  <!-- Company Selector -->
  <label for="companySelect">Select Company:</label>
  <select id="companySelect">
    <option value="acme">Acme Corp</option>
    <option value="zenith">Zenith LLC</option>
    <option value="nova">Nova Industries</option>
  </select>

  <!-- Company Header -->
  <div class="company-header" role="region" aria-label="Company Summary">
    <h2 id="headerCompanyName">Company Name</h2>
    <p id="headerLocation">City, State</p>
    <p id="headerType">Type: <span></span></p>
    <p id="headerRole">Role: <span></span></p>
  </div>

  <div class="summary" id="summary"></div>
  <table id="report">
    <thead>
      <tr>
        <th>Account</th>
        <th>Type</th>
        <th>Balance</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const companyMeta = {
      acme: { name: "Acme Corp", location: "New York, NY", type: "Manufacturing", role: "Owner" },
      zenith: { name: "Zenith LLC", location: "Austin, TX", type: "Consulting", role: "Partner" },
      nova: { name: "Nova Industries", location: "San Francisco, CA", type: "Tech Startup", role: "Investor" }
    };

    async function loadAccounts(companyKey) {
      const response = await fetch(`journal-${companyKey}.html`);
      const text = await response.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(text, 'text/html');
      const rows = doc.querySelectorAll('#accounts tbody tr');

      let totalAssets = 0;
      let totalLiabilities = 0;
      const reportBody = document.querySelector('#report tbody');
      reportBody.innerHTML = ''; // Clear previous rows

      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const [account, type, balanceStr] = Array.from(cells).map(cell => cell.textContent.trim());
        const balance = parseFloat(balanceStr);

        const newRow = document.createElement('tr');
        newRow.innerHTML = `
          <td>${account}</td>
          <td>${type}</td>
          <td class="${type.toLowerCase()}">${balance.toFixed(2)}</td>
        `;
        reportBody.appendChild(newRow);

        if (type === 'Asset') totalAssets += balance;
        else if (type === 'Liability') totalLiabilities += balance;
      });

      const netWorth = totalAssets - totalLiabilities;
      document.getElementById('summary').innerHTML = `
        <p><strong>Total Assets:</strong> <span class="asset">${totalAssets.toFixed(2)}</span></p>
        <p><strong>Total Liabilities:</strong> <span class="liability">${totalLiabilities.toFixed(2)}</span></p>
        <p><strong>Net Worth:</strong> <strong>${netWorth.toFixed(2)}</strong></p>
      `;

      const meta = companyMeta[companyKey];
      document.getElementById('headerCompanyName').textContent = meta.name;
      document.getElementById('headerLocation').textContent = meta.location;
      document.querySelector('#headerType span').textContent = meta.type;
      document.querySelector('#headerRole span').textContent = meta.role;
    }

    document.getElementById('companySelect').addEventListener('change', (e) => {
      loadAccounts(e.target.value);
    });

    // Initial load
    loadAccounts(document.getElementById('companySelect').value);
  </script>
</body>
</html>